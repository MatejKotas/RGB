<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RGB Settings</title>
</head>
<body>
    Mode: <input type="number" min="0" max="0" step="1" class="input" id="mode"><br>
    White multiplier: <input type="number" min="0" step="0.1" class="input" id="white_multiplier"><br>
    Smoothing: <input type="number" min="0" step="0.1" class="input" id="smoothing"><br>
    Wobble: <input type="number" min="0" max="1" step="0.1" class="input" id="wobble"><br>
    Wobble start: <input type="number" min="0" step="1" class="input" id="wobble_start" value="60"><br>
    Brightness: <input type="number" min="0" max="1" step="0.1" class="input" id="brightness"><br>
    Bass start: <input type="number" min="0" step="1" class="input" id="bass_start"><br>
    Bass multiplier: <input type="number" min="0" max="1" step="0.1" class="input" id="bass_multiplier"><br>
    Minimum: <input type="color" class="input" id="minimum"><br>
    White: <input type="color" class="input" id="white"><br>

    <script>
        const elements = document.getElementsByClassName("input")

        function send() {
            const data = {};
            
            for (let element of elements) {
                data[element.id] = element.value;
            }

            socket.send(JSON.stringify(data))
        }

        Array.from(elements).forEach(element => {
            element.addEventListener('change', send)
        })

        // Create WebSocket connection.
        const socket = new WebSocket("ws://localhost:8766");

        // Connection opened
        socket.addEventListener("open", (event) => {
            socket.send("hello");
        });

        // Listen for messages
        socket.addEventListener("message", (event) => {
            const data = JSON.parse(event.data)

            for (const [id, value] of Object.entries(data)) {
                document.getElementById(id).value = value
            }
        });
    </script>
</body>
</html>